using HDF5
using FastGaussQuadrature

export @msave

linspace(a,b,n=100)=[range(a,stop=b,length=n)...]
data=raw"../data/data.h5"

xgauss,wgauss=[[.50000000000000000000], [.21132486540518711774, .78867513459481288226], [.11270166537925831148, .50000000000000000000, .88729833462074168852], [0.6943184420297371239e-1, .33000947820757186760, .66999052179242813240, .93056815579702628761], [0.4691007703066800360e-1, .23076534494715845448, .50000000000000000000, .76923465505284154552, .95308992296933199640], [0.3376524289842398610e-1, .16939530676686774317, .38069040695840154568, .61930959304159845432, .83060469323313225683, .96623475710157601390], [0.2544604382862073774e-1, .12923440720030278007, .29707742431130141654, .50000000000000000000, .50000000000000000000, .70292257568869858346, .87076559279969721993, .97455395617137926226], [0.1985507175123188416e-1, .10166676129318663020, .23723379504183550709, .40828267875217509753, .59171732124782490247, .76276620495816449291, .89833323870681336980, .98014492824876811584], [0.1591988024618695508e-1, 0.8198444633668210285e-1, .19331428364970480134, .33787328829809553548, .50000000000000000000, .66212671170190446452, .80668571635029519866, .91801555366331789715, .98408011975381304492], [0.1304673574141413996e-1, 0.6746831665550774464e-1, .16029521585048779688, .28330230293537640460, .42556283050918439456, .57443716949081560544, .71669769706462359540, .83970478414951220312, .93253168334449225536, .98695326425858586004]], [[1.0000000000000000000], [.50000000000000000000, .50000000000000000000], [.27777777777777777778, .44444444444444444444, .27777777777777777778], [.17392742256872692868, .32607257743127307132, .32607257743127307132, .17392742256872692868], [.11846344252809454376, .23931433524968323402, .28444444444444444444, .23931433524968323402, .11846344252809454376], [0.85662246189585172520e-1, .18038078652406930378, .23395696728634552370, .23395696728634552370, .18038078652406930378, 0.85662246189585172520e-1], [0.64742483084434846635e-1, .13985269574463833395, .19091502525255947248, .20897959183673469388, .20897959183673469388, .19091502525255947248, .13985269574463833395, 0.64742483084434846635e-1], [0.50614268145188129575e-1, .11119051722668723527, .15685332293894364367, .18134189168918099148, .18134189168918099148, .15685332293894364367, .11119051722668723527, 0.50614268145188129575e-1], [0.40637194180787205986e-1, 0.90324080347428702025e-1, .13030534820146773116, .15617353852000142004, .16511967750062988158, .15617353852000142004, .13030534820146773116, 0.90324080347428702025e-1, 0.40637194180787205986e-1], [0.33335672154344068797e-1, 0.74725674575290296570e-1, .10954318125799102200, .13463335965499817754, .14776211235737643508, .14776211235737643508, .13463335965499817754, .10954318125799102200, 0.74725674575290296570e-1, 0.33335672154344068797e-1]]

function load(name::String)
    file=h5open(data,"r")
    v=read(file,name)
    close(file)
    return v
end

macro msave(vs...)
quote
    file=h5open(data,"w")
    for v in $vs
        name=string(v)
        write(file,name,Core.eval(Main, v))
    end
    close(file)
end
end

function prequad(f,a,b,n=10)
    x,w=gausslegendre(n)
    x=a.+(x.+1)*(b-a)/2
    x, f.(x).*w*(b-a)/2
end
