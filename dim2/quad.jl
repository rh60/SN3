abstract type Quad end

struct QuadSeg <: Quad
    Points::Vector{Float64}
    Weights::Vector{Float64}
    function QuadSeg(nq::Int)
        n=div(nq,2)+1
        x,w = gausslegendre(n)
        new( (x.+1)/2, w/2 )
    end
end

struct Coords
    x::Vector{Float64}
    y::Vector{Float64}
end

struct QuadTri <: Quad
    Points::Coords
    Weights::Vector{Float64}
    function QuadTri(nq::Int=1)
        if nq == 1 # integrates exactly linear polynomials
            Q = [0.3333333333333334,0.3333333333333334,0.5000000000000000]
        elseif nq == 2 # integrates exactly quadratic polynomials
            Q = [0.1666666666666667 0.6666666666666666 0.1666666666666667
                0.6666666666666666 0.1666666666666667 0.1666666666666667
                0.1666666666666667 0.1666666666666667 0.1666666666666667]
        elseif nq == 4 # integrates exactly polynomials
            Q = [0.4459484909159649 0.1081030181680702 0.1116907948390057
                0.1081030181680702 0.4459484909159649 0.1116907948390057
                0.4459484909159649 0.4459484909159649 0.1116907948390057
                0.0915762135097707 0.8168475729804585 0.0549758718276609
                0.8168475729804585 0.0915762135097707 0.0549758718276609
                0.0915762135097707 0.0915762135097707 0.0549758718276609]
        elseif nq == 5 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.1125000000000000
                0.1012865073234563 0.7974269853530873 0.0629695902724136
                0.7974269853530873 0.1012865073234563 0.0629695902724136
                0.1012865073234563 0.1012865073234563 0.0629695902724136
                0.4701420641051151 0.0597158717897698 0.0661970763942531
                0.0597158717897698 0.4701420641051151 0.0661970763942531
                0.4701420641051151 0.4701420641051151 0.0661970763942531]
        elseif nq == 6 # integrates exactly polynomials
            Q = [0.0630890144915022 0.8738219710169955 0.0254224531851034
                0.8738219710169955 0.0630890144915022 0.0254224531851034
                0.0630890144915022 0.0630890144915022 0.0254224531851034
                0.2492867451709104 0.5014265096581791 0.0583931378631897
                0.5014265096581791 0.2492867451709104 0.0583931378631897
                0.2492867451709104 0.2492867451709104 0.0583931378631897
                0.0531450498448169 0.6365024991213987 0.0414255378091868
                0.6365024991213987 0.0531450498448169 0.0414255378091868
                0.3103524510337844 0.6365024991213987 0.0414255378091868
                0.6365024991213987 0.3103524510337844 0.0414255378091868
                0.3103524510337844 0.0531450498448169 0.0414255378091868
                0.0531450498448169 0.3103524510337844 0.0414255378091868]
        elseif nq == 7 # integrates exactly polynomials
            Q = [0.0337306485545878 0.9325387028908243 0.0082725250553961
                0.9325387028908243 0.0337306485545878 0.0082725250553961
                0.0337306485545878 0.0337306485545878 0.0082725250553961
                0.2415773825954036 0.5168452348091929 0.0639720856150778
                0.5168452348091929 0.2415773825954036 0.0639720856150778
                0.2415773825954036 0.2415773825954036 0.0639720856150778
                0.4743096925047182 0.0513806149905635 0.0385433230929930
                0.0513806149905635 0.4743096925047182 0.0385433230929930
                0.4743096925047182 0.4743096925047182 0.0385433230929930
                0.0470366446525952 0.7542800405500532 0.0279393664515999
                0.7542800405500532 0.0470366446525952 0.0279393664515999
                0.1986833147973516 0.7542800405500532 0.0279393664515999
                0.7542800405500532 0.1986833147973516 0.0279393664515999
                0.1986833147973516 0.0470366446525952 0.0279393664515999
                0.0470366446525952 0.1986833147973516 0.0279393664515999]
        elseif nq == 8 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0721578038388936
                0.4592925882927231 0.0814148234145537 0.0475458171336423
                0.0814148234145537 0.4592925882927231 0.0475458171336423
                0.4592925882927231 0.4592925882927231 0.0475458171336423
                0.1705693077517602 0.6588613844964796 0.0516086852673591
                0.6588613844964796 0.1705693077517602 0.0516086852673591
                0.1705693077517602 0.1705693077517602 0.0516086852673591
                0.0505472283170310 0.8989055433659381 0.0162292488115990
                0.8989055433659381 0.0505472283170310 0.0162292488115990
                0.0505472283170310 0.0505472283170310 0.0162292488115990
                0.0083947774099576 0.7284923929554042 0.0136151570872175
                0.7284923929554042 0.0083947774099576 0.0136151570872175
                0.2631128296346381 0.7284923929554042 0.0136151570872175
                0.7284923929554042 0.2631128296346381 0.0136151570872175
                0.2631128296346381 0.0083947774099576 0.0136151570872175
                0.0083947774099576 0.2631128296346381 0.0136151570872175]
        elseif nq == 9 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0485678981413994
                0.4370895914929366 0.1258208170141267 0.0389137705023871
                0.1258208170141267 0.4370895914929366 0.0389137705023871
                0.4370895914929366 0.4370895914929366 0.0389137705023871
                0.1882035356190327 0.6235929287619345 0.0398238694636051
                0.6235929287619345 0.1882035356190327 0.0398238694636051
                0.1882035356190327 0.1882035356190327 0.0398238694636051
                0.4896825191987376 0.0206349616025248 0.0156673501135695
                0.0206349616025248 0.4896825191987376 0.0156673501135695
                0.4896825191987376 0.4896825191987376 0.0156673501135695
                0.0447295133944527 0.9105409732110945 0.0127888378293490
                0.9105409732110945 0.0447295133944527 0.0127888378293490
                0.0447295133944527 0.0447295133944527 0.0127888378293490
                0.0368384120547363 0.7411985987844980 0.0216417696886447
                0.7411985987844980 0.0368384120547363 0.0216417696886447
                0.2219629891607657 0.7411985987844980 0.0216417696886447
                0.7411985987844980 0.2219629891607657 0.0216417696886447
                0.2219629891607657 0.0368384120547363 0.0216417696886447
                0.0368384120547363 0.2219629891607657 0.0216417696886447]
        elseif nq == 10 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0408716645731430
                0.0320553732169435 0.9358892535661130 0.0066764844065748
                0.9358892535661130 0.0320553732169435 0.0066764844065748
                0.0320553732169435 0.0320553732169435 0.0066764844065748
                0.1421611010565644 0.7156777978868712 0.0229789818023724
                0.7156777978868712 0.1421611010565644 0.0229789818023724
                0.1421611010565644 0.1421611010565644 0.0229789818023724
                0.3218129952888354 0.5300541189273440 0.0319524531982120
                0.5300541189273440 0.3218129952888354 0.0319524531982120
                0.1481328857838206 0.5300541189273440 0.0319524531982120
                0.5300541189273440 0.1481328857838206 0.0319524531982120
                0.1481328857838206 0.3218129952888354 0.0319524531982120
                0.3218129952888354 0.1481328857838206 0.0319524531982120
                0.0296198894887298 0.6012333286834592 0.0170923240814797
                0.6012333286834592 0.0296198894887298 0.0170923240814797
                0.3691467818278110 0.6012333286834592 0.0170923240814797
                0.6012333286834592 0.3691467818278110 0.0170923240814797
                0.3691467818278110 0.0296198894887298 0.0170923240814797
                0.0296198894887298 0.3691467818278110 0.0170923240814797
                0.0283676653399385 0.8079306009228790 0.0126488788536442
                0.8079306009228790 0.0283676653399385 0.0126488788536442
                0.1637017337371825 0.8079306009228790 0.0126488788536442
                0.8079306009228790 0.1637017337371825 0.0126488788536442
                0.1637017337371825 0.0283676653399385 0.0126488788536442
                0.0283676653399385 0.1637017337371825 0.0126488788536442]
        elseif nq == 11 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0428805898661121
                0.0284854176143719 0.9430291647712562 0.0052159352564473
                0.9430291647712562 0.0284854176143719 0.0052159352564473
                0.0284854176143719 0.0284854176143719 0.0052159352564473
                0.2102199567031783 0.5795600865936434 0.0352578420558583
                0.5795600865936434 0.2102199567031783 0.0352578420558583
                0.2102199567031783 0.2102199567031783 0.0352578420558583
                0.1026354827122464 0.7947290345755071 0.0193153796185097
                0.7947290345755071 0.1026354827122464 0.0193153796185097
                0.1026354827122464 0.1026354827122464 0.0193153796185097
                0.4958919009658909 0.0082161980682182 0.0083031365272927
                0.0082161980682182 0.4958919009658909 0.0083031365272927
                0.4958919009658909 0.4958919009658909 0.0083031365272927
                0.4384659267643522 0.1230681464712956 0.0336580770397341
                0.1230681464712956 0.4384659267643522 0.0336580770397341
                0.4384659267643522 0.4384659267643522 0.0336580770397341
                0.1493247886520824 0.8433497836618531 0.0051451447864766
                0.8433497836618531 0.1493247886520824 0.0051451447864766
                0.0073254276860645 0.8433497836618531 0.0051451447864766
                0.8433497836618531 0.0073254276860645 0.0051451447864766
                0.0073254276860645 0.1493247886520824 0.0051451447864766
                0.1493247886520824 0.0073254276860645 0.0051451447864766
                0.0460105001654300 0.6644083741968642 0.0201662383202503
                0.6644083741968642 0.0460105001654300 0.0201662383202503
                0.2895811256377059 0.6644083741968642 0.0201662383202503
                0.6644083741968642 0.2895811256377059 0.0201662383202503
                0.2895811256377059 0.0460105001654300 0.0201662383202503
                0.0460105001654300 0.2895811256377059 0.0201662383202503]
        elseif nq == 12 # integrates exactly polynomials
            Q = [0.4882037509455415 0.0235924981089169 0.0121334190407260
                0.0235924981089169 0.4882037509455415 0.0121334190407260
                0.4882037509455415 0.4882037509455415 0.0121334190407260
                0.1092578276593543 0.7814843446812914 0.0142430260344388
                0.7814843446812914 0.1092578276593543 0.0142430260344388
                0.1092578276593543 0.1092578276593543 0.0142430260344388
                0.2714625070149261 0.4570749859701478 0.0312706065979514
                0.4570749859701478 0.2714625070149261 0.0312706065979514
                0.2714625070149261 0.2714625070149261 0.0312706065979514
                0.0246463634363356 0.9507072731273288 0.0039658212549868
                0.9507072731273288 0.0246463634363356 0.0039658212549868
                0.0246463634363356 0.0246463634363356 0.0039658212549868
                0.4401116486585931 0.1197767026828138 0.0249591674640305
                0.1197767026828138 0.4401116486585931 0.0249591674640305
                0.4401116486585931 0.4401116486585931 0.0249591674640305
                0.2916556797383409 0.6853101639063919 0.0108917925193038
                0.6853101639063919 0.2916556797383409 0.0108917925193038
                0.0230341563552671 0.6853101639063919 0.0108917925193038
                0.6853101639063919 0.0230341563552671 0.0108917925193038
                0.0230341563552671 0.2916556797383409 0.0108917925193038
                0.2916556797383409 0.0230341563552671 0.0108917925193038
                0.1162960196779266 0.6282497516835561 0.0216136818297071
                0.6282497516835561 0.1162960196779266 0.0216136818297071
                0.2554542286385174 0.6282497516835561 0.0216136818297071
                0.6282497516835561 0.2554542286385174 0.0216136818297071
                0.2554542286385174 0.1162960196779266 0.0216136818297071
                0.1162960196779266 0.2554542286385174 0.0216136818297071
                0.8513377925102401 0.1272797172335894 0.0075418387882557
                0.1272797172335894 0.8513377925102401 0.0075418387882557
                0.0213824902561706 0.1272797172335894 0.0075418387882557
                0.1272797172335894 0.0213824902561706 0.0075418387882557
                0.0213824902561706 0.8513377925102401 0.0075418387882557
                0.8513377925102401 0.0213824902561706 0.0075418387882557]
        elseif nq == 13 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0339800182934158
                0.4890769464525394 0.0218461070949213 0.0119972009644474
                0.0218461070949213 0.4890769464525394 0.0119972009644474
                0.4890769464525394 0.4890769464525394 0.0119972009644474
                0.2213722862918329 0.5572554274163342 0.0291392425596000
                0.5572554274163342 0.2213722862918329 0.0291392425596000
                0.2213722862918329 0.2213722862918329 0.0291392425596000
                0.4269414142598004 0.1461171714803992 0.0278009837652267
                0.1461171714803992 0.4269414142598004 0.0278009837652267
                0.4269414142598004 0.4269414142598004 0.0278009837652267
                0.0215096811088432 0.9569806377823136 0.0030261685517696
                0.9569806377823136 0.0215096811088432 0.0030261685517696
                0.0215096811088432 0.0215096811088432 0.0030261685517696
                0.0878954830321973 0.7485071158999522 0.0120895199057969
                0.7485071158999522 0.0878954830321973 0.0120895199057969
                0.1635974010678505 0.7485071158999522 0.0120895199057969
                0.7485071158999522 0.1635974010678505 0.0120895199057969
                0.1635974010678505 0.0878954830321973 0.0120895199057969
                0.0878954830321973 0.1635974010678505 0.0120895199057969
                0.1109220428034634 0.8647077702954428 0.0074827005525828
                0.8647077702954428 0.1109220428034634 0.0074827005525828
                0.0243701869010938 0.8647077702954428 0.0074827005525828
                0.8647077702954428 0.0243701869010938 0.0074827005525828
                0.0243701869010938 0.1109220428034634 0.0074827005525828
                0.1109220428034634 0.0243701869010938 0.0074827005525828
                0.3084417608921178 0.6235459955536755 0.0173206380704242
                0.6235459955536755 0.3084417608921178 0.0173206380704242
                0.0680122435542067 0.6235459955536755 0.0173206380704242
                0.6235459955536755 0.0680122435542067 0.0173206380704242
                0.0680122435542067 0.3084417608921178 0.0173206380704242
                0.3084417608921178 0.0680122435542067 0.0173206380704242
                0.0051263891023824 0.7223577931241880 0.0047953405017716
                0.7223577931241880 0.0051263891023824 0.0047953405017716
                0.2725158177734297 0.7223577931241880 0.0047953405017716
                0.7223577931241880 0.2725158177734297 0.0047953405017716
                0.2725158177734297 0.0051263891023824 0.0047953405017716
                0.0051263891023824 0.2725158177734297 0.0047953405017716]
        elseif nq == 14 # integrates exactly polynomials
            Q = [0.1772055324125434 0.6455889351749131 0.0210812943684965
                0.6455889351749131 0.1772055324125434 0.0210812943684965
                0.1772055324125434 0.1772055324125434 0.0210812943684965
                0.4176447193404539 0.1647105613190922 0.0163941767720627
                0.1647105613190922 0.4176447193404539 0.0163941767720627
                0.4176447193404539 0.4176447193404539 0.0163941767720627
                0.0617998830908726 0.8764002338182548 0.0072168498348883
                0.8764002338182548 0.0617998830908726 0.0072168498348883
                0.0617998830908726 0.0617998830908726 0.0072168498348883
                0.4889639103621786 0.0220721792756427 0.0109417906847144
                0.0220721792756427 0.4889639103621786 0.0109417906847144
                0.4889639103621786 0.4889639103621786 0.0109417906847144
                0.2734775283088386 0.4530449433823227 0.0258870522536458
                0.4530449433823227 0.2734775283088386 0.0258870522536458
                0.2734775283088386 0.2734775283088386 0.0258870522536458
                0.0193909612487010 0.9612180775025979 0.0024617018012000
                0.9612180775025979 0.0193909612487010 0.0024617018012000
                0.0193909612487010 0.0193909612487010 0.0024617018012000
                0.2983728821362578 0.6869801678080878 0.0072181540567669
                0.6869801678080878 0.2983728821362578 0.0072181540567669
                0.0146469500556544 0.6869801678080878 0.0072181540567669
                0.6869801678080878 0.0146469500556544 0.0072181540567669
                0.0146469500556544 0.2983728821362578 0.0072181540567669
                0.2983728821362578 0.0146469500556544 0.0072181540567669
                0.0571247574036479 0.7706085547749965 0.0123328766062818
                0.7706085547749965 0.0571247574036479 0.0123328766062818
                0.1722666878213556 0.7706085547749965 0.0123328766062818
                0.7706085547749965 0.1722666878213556 0.0123328766062818
                0.1722666878213556 0.0571247574036479 0.0123328766062818
                0.0571247574036479 0.1722666878213556 0.0123328766062818
                0.3368614597963450 0.5702222908466832 0.0192857553935303
                0.5702222908466832 0.3368614597963450 0.0192857553935303
                0.0929162493569718 0.5702222908466832 0.0192857553935303
                0.5702222908466832 0.0929162493569718 0.0192857553935303
                0.0929162493569718 0.3368614597963450 0.0192857553935303
                0.3368614597963450 0.0929162493569718 0.0192857553935303
                0.0012683309328720 0.8797571713701711 0.0025051144192503
                0.8797571713701711 0.0012683309328720 0.0025051144192503
                0.1189744976969568 0.8797571713701711 0.0025051144192503
                0.8797571713701711 0.1189744976969568 0.0025051144192503
                0.1189744976969568 0.0012683309328720 0.0025051144192503
                0.0012683309328720 0.1189744976969568 0.0025051144192503]
        elseif nq == 15 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0221676936910920
                0.4053622141339755 0.1892755717320491 0.0213568907857303
                0.1892755717320491 0.4053622141339755 0.0213568907857303
                0.4053622141339755 0.4053622141339755 0.0213568907857303
                0.0701735528999860 0.8596528942000279 0.0082223687813126
                0.8596528942000279 0.0701735528999860 0.0082223687813126
                0.0701735528999860 0.0701735528999860 0.0082223687813126
                0.4741706814380198 0.0516586371239604 0.0086980740003817
                0.0516586371239604 0.4741706814380198 0.0086980740003817
                0.4741706814380198 0.4741706814380198 0.0086980740003817
                0.2263787134203496 0.5472425731593008 0.0233916808643548
                0.5472425731593008 0.2263787134203496 0.0233916808643548
                0.2263787134203496 0.2263787134203496 0.0233916808643548
                0.4949969567691262 0.0100060864617476 0.0047869230912300
                0.0100060864617476 0.4949969567691262 0.0047869230912300
                0.4949969567691262 0.4949969567691262 0.0047869230912300
                0.0158117262509886 0.9683765474980227 0.0014803873189527
                0.9683765474980227 0.0158117262509886 0.0014803873189527
                0.0158117262509886 0.0158117262509886 0.0014803873189527
                0.0183761123856811 0.6669756448018681 0.0078012864152880
                0.6669756448018681 0.0183761123856811 0.0078012864152880
                0.3146482428124509 0.6669756448018681 0.0078012864152880
                0.6669756448018681 0.3146482428124509 0.0078012864152880
                0.3146482428124509 0.0183761123856811 0.0078012864152880
                0.0183761123856811 0.3146482428124509 0.0078012864152880
                0.0091392370373084 0.9199121577262361 0.0020149266860090
                0.9199121577262361 0.0091392370373084 0.0020149266860090
                0.0709486052364555 0.9199121577262361 0.0020149266860090
                0.9199121577262361 0.0709486052364555 0.0020149266860090
                0.0709486052364555 0.0091392370373084 0.0020149266860090
                0.0091392370373084 0.0709486052364555 0.0020149266860090
                0.1905355894763939 0.7152223569314506 0.0143602934626007
                0.7152223569314506 0.1905355894763939 0.0143602934626007
                0.0942420535921554 0.7152223569314506 0.0143602934626007
                0.7152223569314506 0.0942420535921554 0.0143602934626007
                0.0942420535921554 0.1905355894763939 0.0143602934626007
                0.1905355894763939 0.0942420535921554 0.0143602934626007
                0.1680686452224144 0.8132926410494192 0.0058363105907879
                0.8132926410494192 0.1680686452224144 0.0058363105907879
                0.0186387137281664 0.8132926410494192 0.0058363105907879
                0.8132926410494192 0.0186387137281664 0.0058363105907879
                0.0186387137281664 0.1680686452224144 0.0058363105907879
                0.1680686452224144 0.0186387137281664 0.0058363105907879
                0.3389506114752772 0.5652526648771142 0.0156577381424846
                0.5652526648771142 0.3389506114752772 0.0156577381424846
                0.0957967236476086 0.5652526648771142 0.0156577381424846
                0.5652526648771142 0.0957967236476086 0.0156577381424846
                0.0957967236476086 0.3389506114752772 0.0156577381424846
                0.3389506114752772 0.0957967236476086 0.0156577381424846]
        elseif nq == 16 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0226322830369094
                0.2459900704671417 0.5080198590657166 0.0205464615718495
                0.5080198590657166 0.2459900704671417 0.0205464615718495
                0.2459900704671417 0.2459900704671417 0.0205464615718495
                0.4155848968854205 0.1688302062291590 0.0203559166562127
                0.1688302062291590 0.4155848968854205 0.0203559166562127
                0.4155848968854205 0.4155848968854205 0.0203559166562127
                0.0853555665867003 0.8292888668265994 0.0073908173451122
                0.8292888668265994 0.0853555665867003 0.0073908173451122
                0.0853555665867003 0.0853555665867003 0.0073908173451122
                0.1619186441912712 0.6761627116174576 0.0147092048494940
                0.6761627116174576 0.1619186441912712 0.0147092048494940
                0.1619186441912712 0.1619186441912712 0.0147092048494940
                0.5000000000000000 0.0000000000000000 0.0022092731560753
                0.0000000000000000 0.5000000000000000 0.0022092731560753
                0.5000000000000000 0.5000000000000000 0.0022092731560753
                0.4752807275459421 0.0494385449081158 0.0129871666491386
                0.0494385449081158 0.4752807275459421 0.0129871666491386
                0.4752807275459421 0.4752807275459421 0.0129871666491386
                0.0547551749147031 0.7541700614447677 0.0094691362322078
                0.7541700614447677 0.0547551749147031 0.0094691362322078
                0.1910747636405291 0.7541700614447677 0.0094691362322078
                0.7541700614447677 0.1910747636405291 0.0094691362322078
                0.1910747636405291 0.0547551749147031 0.0094691362322078
                0.0547551749147031 0.1910747636405291 0.0094691362322078
                0.0232034277688137 0.9682443680309587 0.0008272333574175
                0.9682443680309587 0.0232034277688137 0.0008272333574175
                0.0085522042002276 0.9682443680309587 0.0008272333574175
                0.9682443680309587 0.0085522042002276 0.0008272333574175
                0.0085522042002276 0.0232034277688137 0.0008272333574175
                0.0232034277688137 0.0085522042002276 0.0008272333574175
                0.0189317782804059 0.6493036982454464 0.0075043008921429
                0.6493036982454464 0.0189317782804059 0.0075043008921429
                0.3317645234741476 0.6493036982454464 0.0075043008921429
                0.6493036982454464 0.3317645234741476 0.0075043008921429
                0.3317645234741476 0.0189317782804059 0.0075043008921429
                0.0189317782804059 0.3317645234741476 0.0075043008921429
                0.0190301297436974 0.9002737032704295 0.0039737969666962
                0.9002737032704295 0.0190301297436974 0.0039737969666962
                0.0806961669858730 0.9002737032704295 0.0039737969666962
                0.9002737032704295 0.0806961669858730 0.0039737969666962
                0.0806961669858730 0.0190301297436974 0.0039737969666962
                0.0190301297436974 0.0806961669858730 0.0039737969666962
                0.1026061902393981 0.5891488405642479 0.0159918050396850
                0.5891488405642479 0.1026061902393981 0.0159918050396850
                0.3082449691963540 0.5891488405642479 0.0159918050396850
                0.5891488405642479 0.3082449691963540 0.0159918050396850
                0.3082449691963540 0.1026061902393981 0.0159918050396850
                0.1026061902393981 0.3082449691963540 0.0159918050396850
                0.0059363500168222 0.8066218674993957 0.0026955935584244
                0.8066218674993957 0.0059363500168222 0.0026955935584244
                0.1874417824837821 0.8066218674993957 0.0026955935584244
                0.8066218674993957 0.1874417824837821 0.0026955935584244
                0.1874417824837821 0.0059363500168222 0.0026955935584244
                0.0059363500168222 0.1874417824837821 0.0026955935584244]
        elseif nq == 17 # integrates exactly polynomials
            Q = [0.4171034443615992 0.1657931112768016 0.0136554632640511
                0.1657931112768016 0.4171034443615992 0.0136554632640511
                0.4171034443615992 0.4171034443615992 0.0136554632640511
                0.0147554916607540 0.9704890166784921 0.0013869437888188
                0.9704890166784921 0.0147554916607540 0.0013869437888188
                0.0147554916607540 0.0147554916607540 0.0013869437888188
                0.4655978716188903 0.0688042567622194 0.0125097254752487
                0.0688042567622194 0.4655978716188903 0.0125097254752487
                0.4655978716188903 0.4655978716188903 0.0125097254752487
                0.1803581162663706 0.6392837674672588 0.0131563152940090
                0.6392837674672588 0.1803581162663706 0.0131563152940090
                0.1803581162663706 0.1803581162663706 0.0131563152940090
                0.0666540634795969 0.8666918730408062 0.0062295004011527
                0.8666918730408062 0.0666540634795969 0.0062295004011527
                0.0666540634795969 0.0666540634795969 0.0062295004011527
                0.2857065024365866 0.4285869951268267 0.0188581185763976
                0.4285869951268267 0.2857065024365866 0.0188581185763976
                0.2857065024365866 0.2857065024365866 0.0188581185763976
                0.0160176423621193 0.8247900701650881 0.0039891501029648
                0.8247900701650881 0.0160176423621193 0.0039891501029648
                0.1591922874727927 0.8247900701650881 0.0039891501029648
                0.8247900701650881 0.1591922874727927 0.0039891501029648
                0.1591922874727927 0.0160176423621193 0.0039891501029648
                0.0160176423621193 0.1591922874727927 0.0039891501029648
                0.3062815917461865 0.6263690303864522 0.0112438862733455
                0.6263690303864522 0.3062815917461865 0.0112438862733455
                0.0673493778673612 0.6263690303864522 0.0112438862733455
                0.6263690303864522 0.0673493778673612 0.0112438862733455
                0.0673493778673612 0.3062815917461865 0.0112438862733455
                0.3062815917461865 0.0673493778673612 0.0112438862733455
                0.0132296727600869 0.5712948679446841 0.0051992199779198
                0.5712948679446841 0.0132296727600869 0.0051992199779198
                0.4154754592952291 0.5712948679446841 0.0051992199779198
                0.5712948679446841 0.4154754592952291 0.0051992199779198
                0.4154754592952291 0.0132296727600869 0.0051992199779198
                0.0132296727600869 0.4154754592952291 0.0051992199779198
                0.0780423405682824 0.7532351459364581 0.0102789491602273
                0.7532351459364581 0.0780423405682824 0.0102789491602273
                0.1687225134952595 0.7532351459364581 0.0102789491602273
                0.7532351459364581 0.1687225134952595 0.0102789491602273
                0.1687225134952595 0.0780423405682824 0.0102789491602273
                0.0780423405682824 0.1687225134952595 0.0102789491602273
                0.0131358708340027 0.7150722591106424 0.0043461072505006
                0.7150722591106424 0.0131358708340027 0.0043461072505006
                0.2717918700553549 0.7150722591106424 0.0043461072505006
                0.7150722591106424 0.2717918700553549 0.0043461072505006
                0.2717918700553549 0.0131358708340027 0.0043461072505006
                0.0131358708340027 0.2717918700553549 0.0043461072505006
                0.0115751759031806 0.9159193532978169 0.0022921742008679
                0.9159193532978169 0.0115751759031806 0.0022921742008679
                0.0725054707990024 0.9159193532978169 0.0022921742008679
                0.9159193532978169 0.0725054707990024 0.0022921742008679
                0.0725054707990024 0.0115751759031806 0.0022921742008679
                0.0115751759031806 0.0725054707990024 0.0022921742008679
                0.1575054779268699 0.5432755795961598 0.0130858129676685
                0.5432755795961598 0.1575054779268699 0.0130858129676685
                0.2992189424769703 0.5432755795961598 0.0130858129676685
                0.5432755795961598 0.2992189424769703 0.0130858129676685
                0.2992189424769703 0.1575054779268699 0.0130858129676685
                0.1575054779268699 0.2992189424769703 0.0130858129676685]
        elseif nq == 18 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0181778676507133
                0.3999556280675762 0.2000887438648475 0.0166522350166951
                0.2000887438648475 0.3999556280675762 0.0166522350166951
                0.3999556280675762 0.3999556280675762 0.0166522350166951
                0.4875803015748695 0.0248393968502609 0.0060233238169999
                0.0248393968502609 0.4875803015748695 0.0060233238169999
                0.4875803015748695 0.4875803015748695 0.0060233238169999
                0.4618095064064492 0.0763809871871015 0.0094745857533894
                0.0763809871871015 0.4618095064064492 0.0094745857533894
                0.4618095064064492 0.4618095064064492 0.0094745857533894
                0.2422647025142720 0.5154705949714561 0.0182375447044718
                0.5154705949714561 0.2422647025142720 0.0182375447044718
                0.2422647025142720 0.2422647025142720 0.0182375447044718
                0.0388302560886856 0.9223394878226288 0.0035646630098595
                0.9223394878226288 0.0388302560886856 0.0035646630098595
                0.0388302560886856 0.0388302560886856 0.0035646630098595
                0.0919477421216432 0.8161045157567136 0.0082795799760016
                0.8161045157567136 0.0919477421216432 0.0082795799760016
                0.0919477421216432 0.0919477421216432 0.0082795799760016
                0.0458049158598608 0.7703723762146752 0.0068798081174711
                0.7703723762146752 0.0458049158598608 0.0068798081174711
                0.1838227079254640 0.7703723762146752 0.0068798081174711
                0.7703723762146752 0.1838227079254640 0.0068798081174711
                0.1838227079254640 0.0458049158598608 0.0068798081174711
                0.0458049158598608 0.1838227079254640 0.0068798081174711
                0.2063492574338379 0.6709539851942345 0.0118909554500764
                0.6709539851942345 0.2063492574338379 0.0118909554500764
                0.1226967573719275 0.6709539851942345 0.0118909554500764
                0.6709539851942345 0.1226967573719275 0.0118909554500764
                0.1226967573719275 0.2063492574338379 0.0118909554500764
                0.2063492574338379 0.1226967573719275 0.0118909554500764
                0.0038976110334734 0.6004189546342569 0.0022652672511285
                0.6004189546342569 0.0038976110334734 0.0022652672511285
                0.3956834343322697 0.6004189546342569 0.0022652672511285
                0.6004189546342569 0.3956834343322697 0.0022652672511285
                0.3956834343322697 0.0038976110334734 0.0022652672511285
                0.0038976110334734 0.3956834343322697 0.0022652672511285
                0.0134620167414450 0.8783421894675217 0.0034200550598036
                0.8783421894675217 0.0134620167414450 0.0034200550598036
                0.1081957937910333 0.8783421894675217 0.0034200550598036
                0.8783421894675217 0.1081957937910333 0.0034200550598036
                0.1081957937910333 0.0134620167414450 0.0034200550598036
                0.0134620167414450 0.1081957937910333 0.0034200550598036
                0.0402602834699081 0.6399880920047146 0.0088737445510102
                0.6399880920047146 0.0402602834699081 0.0088737445510102
                0.3197516245253773 0.6399880920047146 0.0088737445510102
                0.6399880920047146 0.3197516245253773 0.0088737445510102
                0.3197516245253773 0.0402602834699081 0.0088737445510102
                0.0402602834699081 0.3197516245253773 0.0088737445510102
                0.0052983351866098 0.7589294798551984 0.0025053304372899
                0.7589294798551984 0.0052983351866098 0.0025053304372899
                0.2357721849581917 0.7589294798551984 0.0025053304372899
                0.7589294798551984 0.2357721849581917 0.0025053304372899
                0.2357721849581917 0.0052983351866098 0.0025053304372899
                0.0052983351866098 0.2357721849581917 0.0025053304372899
                0.0005483600420423 0.9723607289627957 0.0006114740634805
                0.9723607289627957 0.0005483600420423 0.0006114740634805
                0.0270909109951620 0.9723607289627957 0.0006114740634805
                0.9723607289627957 0.0270909109951620 0.0006114740634805
                0.0270909109951620 0.0005483600420423 0.0006114740634805
                0.0005483600420423 0.0270909109951620 0.0006114740634805
                0.1205876951639246 0.5459187753861946 0.0127410876559122
                0.5459187753861946 0.1205876951639246 0.0127410876559122
                0.3334935294498808 0.5459187753861946 0.0127410876559122
                0.5459187753861946 0.3334935294498808 0.0127410876559122
                0.3334935294498808 0.1205876951639246 0.0127410876559122
                0.1205876951639246 0.3334935294498808 0.0127410876559122]
        elseif nq == 19 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0172346988520062
                0.0525238903512090 0.8949522192975821 0.0035546282988991
                0.8949522192975821 0.0525238903512090 0.0035546282988991
                0.0525238903512090 0.0525238903512090 0.0035546282988991
                0.4925126750413369 0.0149746499173263 0.0051608775714721
                0.0149746499173263 0.4925126750413369 0.0051608775714721
                0.4925126750413369 0.4925126750413369 0.0051608775714721
                0.1114488733230214 0.7771022533539573 0.0076171755465091
                0.7771022533539573 0.1114488733230214 0.0076171755465091
                0.1114488733230214 0.1114488733230214 0.0076171755465091
                0.4591942010395437 0.0816115979209127 0.0114917950133708
                0.0816115979209127 0.4591942010395437 0.0114917950133708
                0.4591942010395437 0.4591942010395437 0.0114917950133708
                0.4039697225519012 0.1920605548961976 0.0157687674465775
                0.1920605548961976 0.4039697225519012 0.0157687674465775
                0.4039697225519012 0.4039697225519012 0.0157687674465775
                0.1781701047817643 0.6436597904364714 0.0123259574240954
                0.6436597904364714 0.1781701047817643 0.0123259574240954
                0.1781701047817643 0.1781701047817643 0.0123259574240954
                0.0116394611837894 0.9767210776324211 0.0008826613882214
                0.9767210776324211 0.0116394611837894 0.0008826613882214
                0.0116394611837894 0.0116394611837894 0.0008826613882214
                0.2551616329136077 0.4896767341727846 0.0158765096830015
                0.4896767341727846 0.2551616329136077 0.0158765096830015
                0.2551616329136077 0.2551616329136077 0.0158765096830015
                0.1306976762680324 0.8301564644002754 0.0048477422434275
                0.8301564644002754 0.1306976762680324 0.0048477422434275
                0.0391458593316922 0.8301564644002754 0.0048477422434275
                0.8301564644002754 0.0391458593316922 0.0048477422434275
                0.0391458593316922 0.1306976762680324 0.0048477422434275
                0.1306976762680324 0.0391458593316922 0.0048477422434275
                0.3113176298095413 0.5593698057203009 0.0131731609886954
                0.5593698057203009 0.3113176298095413 0.0131731609886954
                0.1293125644701578 0.5593698057203009 0.0131731609886954
                0.5593698057203009 0.1293125644701578 0.0131731609886954
                0.1293125644701578 0.3113176298095413 0.0131731609886954
                0.3113176298095413 0.1293125644701578 0.0131731609886954
                0.0020689258966048 0.6333132931287841 0.0016410382759179
                0.6333132931287841 0.0020689258966048 0.0016410382759179
                0.3646177809746111 0.6333132931287841 0.0016410382759179
                0.6333132931287841 0.3646177809746111 0.0016410382759179
                0.3646177809746111 0.0020689258966048 0.0016410382759179
                0.0020689258966048 0.3646177809746111 0.0016410382759179
                0.0745602946016267 0.7040048199660421 0.0090539724656062
                0.7040048199660421 0.0745602946016267 0.0090539724656062
                0.2214348854323312 0.7040048199660421 0.0090539724656062
                0.7040048199660421 0.2214348854323312 0.0090539724656062
                0.2214348854323312 0.0745602946016267 0.0090539724656062
                0.0745602946016267 0.2214348854323312 0.0090539724656062
                0.0050072882573545 0.8525669543768892 0.0014631575517351
                0.8525669543768892 0.0050072882573545 0.0014631575517351
                0.1424257573657563 0.8525669543768892 0.0014631575517351
                0.8525669543768892 0.1424257573657563 0.0014631575517351
                0.1424257573657563 0.0050072882573545 0.0014631575517351
                0.0050072882573545 0.1424257573657563 0.0014631575517351
                0.0408880111960169 0.6050839790687079 0.0080510813820121
                0.6050839790687079 0.0408880111960169 0.0080510813820121
                0.3540280097352752 0.6050839790687079 0.0080510813820121
                0.6050839790687079 0.3540280097352752 0.0080510813820121
                0.3540280097352752 0.0408880111960169 0.0080510813820121
                0.0408880111960169 0.3540280097352752 0.0080510813820121
                0.2418945789605796 0.7431813689574364 0.0042279437497682
                0.7431813689574364 0.2418945789605796 0.0042279437497682
                0.0149240520819841 0.7431813689574364 0.0042279437497682
                0.7431813689574364 0.0149240520819841 0.0042279437497682
                0.0149240520819841 0.2418945789605796 0.0042279437497682
                0.2418945789605796 0.0149240520819841 0.0042279437497682
                0.0600862753223067 0.9301376988768051 0.0016636006814297
                0.9301376988768051 0.0600862753223067 0.0016636006814297
                0.0097760258008882 0.9301376988768051 0.0016636006814297
                0.9301376988768051 0.0097760258008882 0.0016636006814297
                0.0097760258008882 0.0600862753223067 0.0016636006814297
                0.0600862753223067 0.0097760258008882 0.0016636006814297]
        elseif nq == 20 # integrates exactly polynomials
            Q = [0.3333333333333334 0.3333333333333334 0.0139101107014531
                0.2545792676733391 0.4908414646533218 0.0140832013075202
                0.4908414646533218 0.2545792676733391 0.0140832013075202
                0.2545792676733391 0.2545792676733391 0.0140832013075202
                0.0109761410283978 0.9780477179432046 0.0007988407910666
                0.9780477179432046 0.0109761410283978 0.0007988407910666
                0.0109761410283978 0.0109761410283978 0.0007988407910666
                0.1093835967117146 0.7812328065765708 0.0078302307760745
                0.7812328065765708 0.1093835967117146 0.0078302307760745
                0.1093835967117146 0.1093835967117146 0.0078302307760745
                0.1862949977445409 0.6274100045109181 0.0091734629742529
                0.6274100045109181 0.1862949977445409 0.0091734629742529
                0.1862949977445409 0.1862949977445409 0.0091734629742529
                0.4455510569559248 0.1088978860881504 0.0094523999332324
                0.1088978860881504 0.4455510569559248 0.0094523999332324
                0.4455510569559248 0.4455510569559248 0.0094523999332324
                0.0373108805988847 0.9253782388022307 0.0021612754106656
                0.9253782388022307 0.0373108805988847 0.0021612754106656
                0.0373108805988847 0.0373108805988847 0.0021612754106656
                0.3934253478170999 0.2131493043658003 0.0137880506290705
                0.2131493043658003 0.3934253478170999 0.0137880506290705
                0.3934253478170999 0.3934253478170999 0.0137880506290705
                0.4762456115404990 0.0475087769190020 0.0071018253034084
                0.0475087769190020 0.4762456115404990 0.0071018253034084
                0.4762456115404990 0.4762456115404990 0.0071018253034084
                0.0075707805046965 0.8332955118382362 0.0022028974185585
                0.8332955118382362 0.0075707805046965 0.0022028974185585
                0.1591337076570672 0.8332955118382362 0.0022028974185585
                0.8332955118382362 0.1591337076570672 0.0022028974185585
                0.1591337076570672 0.0075707805046965 0.0022028974185585
                0.0075707805046965 0.1591337076570672 0.0022028974185585
                0.0465603649076643 0.7549215028635474 0.0059863985789547
                0.7549215028635474 0.0465603649076643 0.0059863985789547
                0.1985181322287882 0.7549215028635474 0.0059863985789547
                0.7549215028635474 0.1985181322287882 0.0059863985789547
                0.1985181322287882 0.0465603649076643 0.0059863985789547
                0.0465603649076643 0.1985181322287882 0.0059863985789547
                0.0640905856084341 0.9310544767839422 0.0011298696021259
                0.9310544767839422 0.0640905856084341 0.0011298696021259
                0.0048549376076237 0.9310544767839422 0.0011298696021259
                0.9310544767839422 0.0048549376076237 0.0011298696021259
                0.0048549376076237 0.0640905856084341 0.0011298696021259
                0.0640905856084341 0.0048549376076237 0.0011298696021259
                0.0549874791429868 0.6118777035474257 0.0086672255672193
                0.6118777035474257 0.0549874791429868 0.0086672255672193
                0.3331348173095875 0.6118777035474257 0.0086672255672193
                0.6118777035474257 0.3331348173095875 0.0086672255672193
                0.3331348173095875 0.0549874791429868 0.0086672255672193
                0.0549874791429868 0.3331348173095875 0.0086672255672193
                0.0999522962881387 0.8616840189364867 0.0041457115276139
                0.8616840189364867 0.0999522962881387 0.0041457115276139
                0.0383636847753746 0.8616840189364867 0.0041457115276139
                0.8616840189364867 0.0383636847753746 0.0041457115276139
                0.0383636847753746 0.0999522962881387 0.0041457115276139
                0.0999522962881387 0.0383636847753746 0.0041457115276139
                0.1062272047202700 0.6781657378896355 0.0077226078220992
                0.6781657378896355 0.1062272047202700 0.0077226078220992
                0.2156070573900944 0.6781657378896355 0.0077226078220992
                0.6781657378896355 0.2156070573900944 0.0077226078220992
                0.2156070573900944 0.1062272047202700 0.0077226078220992
                0.1062272047202700 0.2156070573900944 0.0077226078220992
                0.4200237588162241 0.5701446928909734 0.0036956815002553
                0.5701446928909734 0.4200237588162241 0.0036956815002553
                0.0098315482928026 0.5701446928909734 0.0036956815002553
                0.5701446928909734 0.0098315482928026 0.0036956815002553
                0.0098315482928026 0.4200237588162241 0.0036956815002553
                0.4200237588162241 0.0098315482928026 0.0036956815002553
                0.3178601238357720 0.5423318041724281 0.0116917457318277
                0.5423318041724281 0.3178601238357720 0.0116917457318277
                0.1398080719917999 0.5423318041724281 0.0116917457318277
                0.5423318041724281 0.1398080719917999 0.0116917457318277
                0.1398080719917999 0.3178601238357720 0.0116917457318277
                0.3178601238357720 0.1398080719917999 0.0116917457318277
                0.0107372128560111 0.7086813757203236 0.0035782002384577
                0.7086813757203236 0.0107372128560111 0.0035782002384577
                0.2805814114236652 0.7086813757203236 0.0035782002384577
                0.7086813757203236 0.2805814114236652 0.0035782002384577
                0.2805814114236652 0.0107372128560111 0.0035782002384577
                0.0107372128560111 0.2805814114236652 0.0035782002384577]
        else
            #nothing doing: this input is wrong
            error( "Unknown rule!" )
        end
        new(Coords(Q[:,1],Q[:,2]),Q[:,3])
    end
end

@inline function intSum(Q::Quad,values::Vector{Float64})::Float64
    values⋅Q.Weights
end

@inline function intSum(Q::QuadTri,f::Function)::Float64
    values = f.(Q.Points.x,Q.Points.y)
    values⋅Q.Weights
end
